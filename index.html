<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hostel Data</title>
    <style>
        /* Add your CSS styles here */
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .box { 
            border: 1px solid #ccc; 
            padding: 10px; 
            margin: 10px; 
            border-radius: 5px; 
            background-color: #f9f9f9; 
        }
        .call-button, .whatsapp-button { 
            margin: 5px; 
            padding: 5px 10px; 
            border: none; 
            border-radius: 5px; 
            background-color: #007bff; 
            color: white; 
            text-decoration: none; 
        }
        .call-button:hover, .whatsapp-button:hover { 
            background-color: #0056b3; 
        }
    </style>
</head>
<body>
    <h1>Hostel Data</h1>

    <label for="citySelect">Select City:</label>
    <select id="citySelect" onchange="fetchAreas()">
        <option value="">--Select a City--</option>
        <!-- City options will be populated here -->
    </select>

    <label for="areaSelect">Select Area:</label>
    <select id="areaSelect">
        <option value="">--Select an Area--</option>
        <!-- Area options will be populated here -->
    </select>

    <button onclick="fetchHostelData()">Fetch Data</button>

    <div id="hostelBoxes"></div>
    <div id="pagination"></div>

    <script>
        const apiUrl = 'YOUR_API_ENDPOINT_HERE'; // Replace with your API endpoint
        const rowsPerPage = 100;  // Set your rows per page here

        // Function to fetch cities
        function fetchCities() {
            fetch(`${apiUrl}?getCities=true`)
                .then(response => response.json())
                .then(data => {
                    const citySelect = document.getElementById('citySelect');
                    data.cities.forEach(city => {
                        const option = document.createElement('option');
                        option.value = city;
                        option.textContent = city;
                        citySelect.appendChild(option);
                    });
                })
                .catch(error => console.error('Error fetching cities:', error));
        }

        // Function to fetch areas based on selected city
        function fetchAreas() {
            const city = document.getElementById('citySelect').value;
            if (city) {
                fetch(`${apiUrl}?getAreas=true&city=${city}`)
                    .then(response => response.json())
                    .then(data => {
                        const areaSelect = document.getElementById('areaSelect');
                        areaSelect.innerHTML = '<option value="">--Select an Area--</option>'; // Clear previous options
                        data.areas.forEach(area => {
                            const option = document.createElement('option');
                            option.value = area;
                            option.textContent = area;
                            areaSelect.appendChild(option);
                        });
                    })
                    .catch(error => console.error('Error fetching areas:', error));
            } else {
                document.getElementById('areaSelect').innerHTML = '<option value="">--Select an Area--</option>'; // Reset areas
            }
        }

        // Fetch hostel data based on selected city and area
        function fetchHostelData() {
            const city = document.getElementById('citySelect').value;
            const area = document.getElementById('areaSelect').value;
            const page = 1; // Default to the first page

            fetch(`${apiUrl}?city=${city}&area=${area}&page=${page}`)
                .then(response => response.json())
                .then(data => {
                    const boxesContainer = document.getElementById('hostelBoxes');
                    boxesContainer.innerHTML = '';

                    if (data.data.length === 0) {
                        boxesContainer.innerHTML = '<p>No hostels found for this city and area.</p>';
                        document.getElementById('pagination').innerHTML = ''; // Clear pagination
                        return;
                    }

                    data.data.forEach((row, index) => {
                        const box = document.createElement('div');
                        box.classList.add('box');
                        box.innerHTML = `
                            <p><strong>S.No:</strong> ${(page - 1) * rowsPerPage + index + 1}</p>
                            <p><strong>Hostel Name:</strong> ${row.hostelName}</p>
                            <p><strong>Area:</strong> ${row.area}</p>
                            <p><strong>City:</strong> ${row.cityName}</p>
                            <a href="tel:${row.phoneNumber}" class="call-button">Call Now</a>
                            <a href="https://wa.me/${row.phoneNumber.replace(/\D/g, '')}" class="whatsapp-button">WhatsApp</a>
                        `;
                        boxesContainer.appendChild(box);
                    });

                    setupPagination(data.total, page); // Function to set up pagination
                })
                .catch(error => console.error('Error fetching hostel data:', error));
        }

        // Pagination setup
        function setupPagination(total, currentPage) {
            const totalPages = Math.ceil(total / rowsPerPage);
            const paginationContainer = document.getElementById('pagination');
            paginationContainer.innerHTML = ''; // Clear existing pagination

            for (let i = 1; i <= totalPages; i++) {
                const button = document.createElement('button');
                button.innerText = i;
                button.disabled = (i === currentPage);
                button.onclick = () => fetchHostelData(i);
                paginationContainer.appendChild(button);
            }
        }

        // Call fetchCities when the page loads
        window.onload = fetchCities;
    </script>
</body>
</html>
